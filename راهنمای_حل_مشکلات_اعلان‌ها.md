# راهنمای حل مشکلات سیستم اعلان‌ها

## مشکلات احتمالی و راه‌حل‌ها:

### 1. مشکل: فایل‌های سرور آپلود نشده‌اند

**علائم:**
- خطای "سرور در دسترس نیست"
- عدم دریافت اعلان‌ها از سرور
- خطای 404 در API calls

**راه‌حل:**
1. فایل‌های زیر را به سرور `https://sechahoon.liara.run` آپلود کنید:
   - `alert_api.php`
   - `manager_alert_api.php`
   - `notification_server.php`

2. تست اتصال با فایل `test_alert_connection.php`

### 2. مشکل: دیتابیس موقت پاک شده

**علائم:**
- اعلان‌های قبلی ناپدید شده‌اند
- خطای "Database file not found"

**راه‌حل:**
- دیتابیس‌ها به طور خودکار در فایل‌های موقت سرور ایجاد می‌شوند
- نیازی به آپلود فایل‌های دیتابیس نیست

### 3. مشکل: عدم همگام‌سازی داده‌ها

**علائم:**
- اعلان‌ها در یک دستگاه نمایش داده نمی‌شوند
- داده‌های محلی و سرور متفاوت هستند

**راه‌حل:**
1. در اپلیکیشن، دکمه "همگام‌سازی" را بزنید
2. یا اپلیکیشن را مجدداً راه‌اندازی کنید

### 4. مشکل: عدم دریافت نوتیفیکیشن

**علائم:**
- اعلان‌ها ایجاد می‌شوند اما نوتیفیکیشن نمی‌آید
- خطا در ارسال نوتیفیکیشن

**راه‌حل:**
1. بررسی کنید که `notification_server.php` آپلود شده باشد
2. مجوزهای نوتیفیکیشن در دستگاه فعال باشد
3. اتصال اینترنت برقرار باشد

### 5. مشکل: خطای دسترسی

**علائم:**
- خطای "شما مجاز به ایجاد اعلان نیستید"
- عدم نمایش اعلان‌های مدیریت

**راه‌حل:**
1. بررسی کنید که کاربر با نقش مناسب وارد شده باشد
2. برای اعلان‌های کارشناسان: مدیر، سرپرست، کارشناس
3. برای اعلان‌های مدیریت: مدیر، رئیس، سرپرست

## مراحل تست کامل:

### مرحله 1: تست اتصال سرور
```bash
php test_alert_connection.php
```

### مرحله 2: تست در اپلیکیشن
1. وارد اپلیکیشن شوید
2. به بخش اعلان‌ها بروید
3. یک اعلان کارشناس ایجاد کنید
4. یک اعلان مدیریت ایجاد کنید
5. بررسی کنید که اعلان‌ها نمایش داده می‌شوند

### مرحله 3: تست نوتیفیکیشن
1. اعلان جدید ایجاد کنید
2. بررسی کنید که نوتیفیکیشن دریافت می‌شود
3. روی نوتیفیکیشن کلیک کنید تا به صفحه اعلان بروید

## فایل‌های مهم:

### فایل‌های سرور (باید آپلود شوند):
- `alert_api.php` - API اعلان‌های کارشناسان
- `manager_alert_api.php` - API اعلان‌های مدیریت  
- `notification_server.php` - سرور نوتیفیکیشن

### فایل‌های اپلیکیشن:
- `lib/services/alert_service.dart` - سرویس اعلان‌های کارشناسان
- `lib/services/manager_alert_service.dart` - سرویس اعلان‌های مدیریت
- `lib/services/server_alert_service.dart` - ارتباط با سرور اعلان‌ها
- `lib/services/server_manager_alert_service.dart` - ارتباط با سرور اعلان‌های مدیریت

## نکات مهم:

1. **اولویت آپلود**: ابتدا فایل‌های سرور را آپلود کنید
2. **تست مرحله‌ای**: هر مرحله را جداگانه تست کنید
3. **لاگ‌ها**: در صورت خطا، لاگ‌های کنسول را بررسی کنید
4. **کش**: در صورت مشکل، کش اپلیکیشن را پاک کنید
5. **اینترنت**: اطمینان حاصل کنید که اتصال اینترنت برقرار است

## تماس با پشتیبانی:

در صورت بروز مشکل:
1. لاگ‌های خطا را ذخیره کنید
2. تصویر از صفحه خطا بگیرید
3. مراحل انجام شده را یادداشت کنید
4. با تیم پشتیبانی تماس بگیرید
